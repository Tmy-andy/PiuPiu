<!-- templates/_sidebar.html -->
<div class="sidebar p-3">
    <button id="toggleSidebar" class="sidebar-toggle-btn mb-2">
        <i class="fas fa-angle-left"></i>
    </button>
    <h5 class="fw-bold text-dark mb-3">
        <i class="fas fa-tachometer-alt me-2"></i>
        {% if user is defined and user.role == 'admin' %}
            Menu Admin
        {% else %}
            Menu Member
        {% endif %}
    </h5>
    <nav class="nav flex-column">
        <a class="nav-link {% if request.endpoint == 'dashboard' %}active{% endif %}" href="{{ url_for('dashboard') }}">
            <i class="fas fa-chart-bar"></i>Thống kê
        </a>

        {% if user.role == 'admin' %}
            <a class="nav-link {% if request.endpoint == 'members' %}active{% endif %}" href="{{ url_for('members') }}">
                <i class="fas fa-users"></i>Quản lý thành viên
            </a>
            <a class="nav-link {% if request.endpoint == 'member_ids' %}active{% endif %}" href="{{ url_for('member_ids') }}">
                <i class="fas fa-id-card"></i>Mã thành viên
            </a>
            <a class="nav-link {% if request.endpoint == 'admins' %}active{% endif %}" href="{{ url_for('admins') }}">
                <i class="fa-solid fa-user-tie"></i>Danh sách admin
            </a>
            <a class="nav-link {% if request.endpoint == 'rules' %}active{% endif %}" href="{{ url_for('rules') }}">
                <i class="fas fa-gavel"></i>Cập nhật luật
            </a>
        {% endif %}

        <!-- Luật công khai, không cần quyền -->
        <a class="nav-link {% if request.endpoint == 'public_rules' %}active{% endif %}" href="{{ url_for('public_rules') }}">
            <i class="fas fa-gavel"></i>Luật
        </a>

        <a class="nav-link {% if request.endpoint == 'abilities' %}active{% endif %}" href="{{ url_for('abilities') }}">
            <i class="fas fa-bolt"></i>Chức năng nhân vật
        </a>
        <a class="nav-link {% if request.endpoint == 'blacklist' %}active{% endif %}" href="{{ url_for('blacklist') }}">
            <i class="fas fa-ban"></i>Blacklist
        </a>
        <a class="nav-link {% if request.endpoint == 'kim_bai' %}active{% endif %}" href="{{ url_for('kim_bai') }}">
            <i class="fa-solid fa-scroll-torah"></i>Kim Bài Miễn Tử
        </a>
        <a class="nav-link {% if request.endpoint == 'top_tier' %}active{% endif %}" href="{{ url_for('top_tier') }}">
            <i class="fas fa-crown"></i> Top Tier
        </a>
        <a class="nav-link {% if request.endpoint == 'game_history' %}active{% endif %}" href="{{ url_for('game_history') }}">
            <i class="fas fa-history"></i>Lịch sử game
        </a>
        <a class="nav-link {% if request.endpoint == 'day_off' %}active{% endif %}" href="{{ url_for('day_off') }}">
            <i class="fas fa-calendar-times"></i>Xin off
        </a>

        {% if user.role == 'admin' %}
        <a class="nav-link" href="{{ url_for('frequency') }}">
            <i class="bi bi-clock-history"></i> Tần suất chơi
            {% if warning_count > 0 %}
            <span class="badge bg-danger rounded-pill ms-2 me-2">{{ warning_count }}</span>
            {% endif %}
        </a>
        {% endif %}
    </nav>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const toggleBtn = document.getElementById("toggleSidebar");
        const sidebar = document.querySelector(".sidebar");
        const contentWrapper = document.getElementById("main-content-wrapper");

        toggleBtn.addEventListener("click", function () {
            sidebar.classList.toggle("collapsed");
            contentWrapper.classList.toggle("expanded");

            const icon = toggleBtn.querySelector("i");
            if (sidebar.classList.contains("collapsed")) {
                icon.classList.remove("fa-angle-left");
                icon.classList.add("fa-angle-right");
            } else {
                icon.classList.remove("fa-angle-right");
                icon.classList.add("fa-angle-left");
            }
        });
    });
</script>
